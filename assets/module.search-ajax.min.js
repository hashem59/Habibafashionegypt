!function(e){"use strict";theme.SearchAjax=function(){function t(){this.settings={default_search_obj:{url:theme.routes.search_url,data:{view:"json"}},suggest_search_obj:{url:theme.routes.search_url+"/suggest.json",data:{resources:{type:theme.search_show_only_products?"product":"product,page",unavailable_products:"last",fields:"title,vendor,product_type,variants.title",options:null}}}},this.selectors={search:".js-search-ajax"},this.load()}t.prototype=e.extend({},t.prototype,{load:function(){var t,s=this,r="";function a(t,s,r,a){var c=t.find(".search-ajax__result"),n=t.find(".search-ajax__view-all"),o=n.find("a"),h=t.find(".search-ajax__empty");o.attr("href",theme.routes.search_url+"?q="+r+"&options[prefix]=last"+(theme.search_show_only_products?"&type=product":"")),n[a.count>0?"removeClass":"addClass"]("d-none-important"),h.html(theme.strings.general.search.no_results_html.replace("{{ terms }}",r))[""===r||a.count>0?"addClass":"removeClass"]("d-none-important"),c.addClass("invisible"),function(t,s,r){if(r.count>0){var a=e(e("#template-search-ajax")[0].content),i=e(document.createDocumentFragment()),c=+t.attr("data-js-max-products")-1;e.each(r.results,(function(e){var t=a.clone(),s=t.find(".product-search-2__image img"),r=t.find(".product-search-2__title a"),n=t.find(".product-search-2__price .price");if(t.find("a").attr("href",this.url),r.html(this.title),this.image?s.attr("srcset",Shopify.resizeImage(this.image,"200x")+" 1x, "+Shopify.resizeImage(this.image,"200x@2x")+" 2x"):s.remove(),n.length)if(this.price){switch(theme.search_result_correction){case"/100":this.price=this.price/100,this.compare_at_price=this.compare_at_price/100;break;case"/10":this.price=this.price/10,this.compare_at_price=this.compare_at_price/10;break;case"*10":this.price=10*this.price,this.compare_at_price=10*this.compare_at_price;break;case"*100":this.price=100*this.price,this.compare_at_price=100*this.compare_at_price}theme.ProductCurrency.setPrice(n,this.price,this.compare_at_price)}else n.remove();return i.append(t),e<c})),s.html(""),s.append(i),theme.ImagesLazyLoad.update(),theme.ProductCurrency.update()}else s.html("");s[r.count>0?"removeClass":"addClass"]("d-none-important")}(t,c,a),c.removeClass("invisible"),theme.Loader.unset(s),t.find('button[type="submit"]').removeClass("disabled"),t.addClass("open"),$body.unbind("click.search-ajax"),$window.unbind("scroll.search-ajax"),$body.on("click.search-ajax",(function(t){e(t.target).parents(".js-search-ajax").length||(i(),$body.unbind("click.search-ajax"))})),$window.on("scroll.search-ajax",(function(){i(),$window.unbind("scroll.search-ajax")}))}function i(t){var i=t||e(s.selectors.search),c=i.find(".search-ajax__content");r="",i.find("input").val(""),a(i,c,r,{count:0}),i.removeClass("open")}$body.on("keyup",this.selectors.search+" input",e.debounce(500,(function(i){var c=e(this).parents(s.selectors.search);if(27!==i.keyCode){var n=e(this).val(),o=c.find(".search-ajax__content");n!==r&&(""===(r=n)?a(c,o,r,{count:0}):(t&&t.abort(),theme.Loader.set(o),c.find('button[type="submit"]').addClass("disabled"),t=e.getJSON(e.extend(!0,{},theme.search_predictive_enabled?s.settings.suggest_search_obj:s.settings.default_search_obj,{type:"GET",data:{q:r},success:function(t){var s={count:Math.min(t.resources.results.products.length+(t.resources.results.pages?t.resources.results.pages.length:0),5),results:[]},i=0;e.each(t.resources.results.products,(function(){if(i>5)return!1;theme.search_predictive_enabled&&-1===this.price_min.indexOf(".")&&(this.price_min*=100),theme.search_predictive_enabled&&-1===this.compare_at_price_min.indexOf(".")&&(this.compare_at_price_min*=100),s.results.push({price:this.price_min,compare_at_price:this.compare_at_price_min,image:this.image,title:this.title,url:this.url}),i++})),e.each(t.resources.results.pages,(function(){if(i>5)return!1;s.results.push({title:this.title,url:this.url,image:this.image||null}),i++})),a(c,o,r,s)}}))))}}))),$body.on("keyup",this.selectors.search+" input",(function(t){if(27===t.keyCode){var i=e(this).parents(s.selectors.search),c=i.find(".search-ajax__content");a(i,c,r="",{count:0})}})),$body.on("clear",this.selectors.search,(function(){i(e(this))}))},closeAll:function(){e(this.selectors.search+".open").trigger("clear")}}),theme.SearchAjax=new t},e((function(){theme.SearchAjax()}))}(jQueryTheme);
!function(i){"use strict";i.widget("ui.productGallery",{options:{id:1,single:!1,media_id_index:[],gallery_has_video:!1,gallery_has_model:!1,video_autoplay:!0,grouped:!1,enable_zoom:!1,zoom_scale_coef:theme.product.gallery_zoom_scale_coef||3,zoom_offset_coef:.75,main:{enabled:!1,device:"all",stretch_size:"auto",slick:{lazyLoad:!1,slidesToShow:1,slidesToScroll:1,dots:!1,arrows:!0,infinite:!1,touchMove:!1,adaptiveHeight:!0,rtl:theme.rtl}},thumbnail:{enabled:!1,device:"desktop",slick:{lazyLoad:!1,vertical:!0,verticalSwiping:!0,slidesToShow:6,slidesToScroll:6,dots:!1,arrows:!0,infinite:!1,touchMove:!1,responsive:[{breakpoint:1259,settings:{slidesToShow:4,slidesToScroll:4}},{breakpoint:1025,settings:{vertical:!1,verticalSwiping:!1,slidesToShow:5,slidesToScroll:5,arrows:!1}}]}},collage:{enabled:!1,device:"desktop"},sheet:{enabled:!1,device:"desktop"},fullscreen:{enabled:!1,device:"desktop",slick:{lazyLoad:!1,slidesToShow:1,slidesToScroll:1,dots:!1,arrows:!0,infinite:!1,touchMove:!1,adaptiveHeight:!1,rtl:theme.rtl}}},_create:function(){var e=this,t=i(".js-popup.active");this.$gallery=this.element,this.$main_slider=this.$gallery.find("[data-js-product-gallery-main-slider]"),this.$scroll_elem=t.length?t:$window;var s=this.$gallery.find("[data-json-options-global]"),n=this.$gallery.find("[data-json-options-layout]");if(s=s.length?JSON.parse(s.html()):{},n=n.length?JSON.parse(n.html()):{},this.options=i.extend(!0,{},this.options,s,n),this.main_slides=[],this.indexes=[],i.each(this.options.media_id_index,(function(i){e.indexes.push(i)})),this.options.grouped&&(this.indexes_cache=this.indexes),this.options.gallery_has_model&&(this._checkModelXrButton=function(i){let e;for(let t of this.indexes)if(this[i][t].$model&&(e=this[i][t].id),t>=this.main_slick.currentSlide&&e)break;this.$buttonXr.attr("data-shopify-model3d-id",e)}),(this.options.gallery_has_video||this.options.gallery_has_model)&&(this.$control_gallery=this.$gallery.find("[data-js-product-gallery-control-video]"),this._loadMedia=function(e,t){var s;this[e][this.indexes[t]].$video&&!this[e][this.indexes[t]].$video[0].hasAttribute("src")?(this[e][this.indexes[t]].$video.attr("poster",this[e][this.indexes[t]].$video.attr("data-poster")),this[e][this.indexes[t]].$video.attr("src",this[e][this.indexes[t]].$video.find("source").first().attr("data-src"))):this[e][this.indexes[t]].$iframe&&!this[e][this.indexes[t]].$iframe.hasClass("loaded")?this[e][this.indexes[t]].$iframe.addClass("loading").one("load",(function(){i(this).addClass("loaded").removeClass("loading")})).attr("src",this[e][this.indexes[t]].$iframe.attr("data-src")):this[e][this.indexes[t]].$template&&!this[e][this.indexes[t]].$template[0].hasAttribute("src")&&(s=i(this[e][this.indexes[t]].$template[0].content).children().first(),this[e][this.indexes[t]].$blockratio?(this[e][this.indexes[t]].$blockratio.find("[data-js-product-gallery-blockratio-content]").html(""),this[e][this.indexes[t]].$blockratio.find("[data-js-product-gallery-blockratio-content]").append(s)):(this[e][this.indexes[t]].$item.html(""),this[e][this.indexes[t]].$item.append(s)),this[e][this.indexes[t]].$model=s,this[e][this.indexes[t]].$template=null),this._checkModelXrButton&&this._checkModelXrButton(e)},this._playVideo=function(i){i.hasClass("playing")||i.addClass("playing")[0].play()},this._pauseVideo=function(i){i.hasClass("playing")&&i.removeClass("playing")[0].pause()},this._playIframe=function(i){i.hasClass("playing")||i.addClass("playing")[0].contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}',"*")},this._pauseIframe=function(i){i.hasClass("playing")&&i.removeClass("playing")[0].contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")},this.switchMedia=function(i,t,s){"play"===s&&this.options.video_autoplay?this[i][this.indexes[t]].$video&&(this[i][this.indexes[t]].$video[0].hasAttribute("src")||this[i][this.indexes[t]].$video.find("source").first()[0].hasAttribute("src"))?this._playVideo(this[i][this.indexes[t]].$video):this[i][this.indexes[t]].$iframe&&(this[i][this.indexes[t]].$iframe.hasClass("loaded")?this._playIframe(this[i][this.indexes[t]].$iframe):this[i][this.indexes[t]].$iframe.hasClass("loading")?this[i][this.indexes[t]].$iframe.one("load",(function(){e._playIframe(e[i][e.indexes[t]].$iframe)})):this[i][this.indexes[t]].$iframe[0].hasAttribute("src")&&this._playIframe(this[i][this.indexes[t]].$iframe)):"pause"===s&&(this[i][this.indexes[t]].$video&&this[i][this.indexes[t]].$video[0].hasAttribute("src")?this._pauseVideo(this[i][this.indexes[t]].$video):this[i][this.indexes[t]].$iframe&&(this[i][this.indexes[t]].$iframe.hasClass("loaded")?this._pauseIframe(this[i][this.indexes[t]].$iframe):this[i][this.indexes[t]].$iframe.hasClass("loading")&&this[i][this.indexes[t]].$iframe.one("load",(function(){e._pauseIframe(e[i][e.indexes[t]].$iframe)}))))}),this.options.enable_zoom&&(this._initZoom=function(){this._getZoomObj=function(){e.zooms={dom:[]},e.fullscreenZooms={dom:[]};var t=this.$gallery.find("[data-js-product-gallery-zoom]"),s=this.$gallery.find("[data-js-product-gallery-fullscreen-zoom]");t.each((function(){var t=i(this);e.zooms.dom.push({$zoom:t,$container:t.find("[data-js-product-gallery-zoom-container]"),$ration:t.find("[data-js-product-gallery-zoom-ratio]"),$image:t.find("[data-js-product-gallery-zoom-image]")})})),s.each((function(){var t=i(this);e.fullscreenZooms.dom.push({$zoom:t,$container:t.find("[data-js-product-gallery-zoom-container]"),$ration:t.find("[data-js-product-gallery-zoom-ratio]"),$image:t.find("[data-js-product-gallery-zoom-image]")})}))},this._updateZoomSize=function(i,e,t,s){this[e][this.indexes[s]].$img&&(this[i].current_size={main_image_width:this[e][this.indexes[s]].$img.innerWidth(),main_image_height:this[e][this.indexes[s]].$img.innerHeight()},this[e][this.indexes[s]].blockratio_width&&this[e][this.indexes[s]].blockratio_width<100&&this[i].dom[t].$container.attr("style","width: "+Math.round(this[e][this.indexes[s]].blockratio_width)+"% !important;"+(this[e][this.indexes[s]].blockratio_width>100?" margin-left: -"+(this[e][this.indexes[s]].blockratio_width-100)/2+"% !important;":"")),this[i].dom[t].$ration.css({"padding-top":100/+this[e][this.indexes[s]].$img.attr("data-aspect-ratio")+"%"}),this[i].dom[t].$image.css({"padding-top":100/+this[e][this.indexes[s]].$img.attr("data-aspect-ratio")+"%"}))},this._switchZoom=function(i,t,s,n,o){if(o){if(this[t][this.indexes[n]].$img&&this[i].current_image_index!==n){var l=function(){var o=e[t][e.indexes[n]].$img.clone();o[0].hasAttribute("srcset")&&o.addClass("donothide"),e._updateZoomSize(i,t,s,n),e[i].dom[s].$image.append(o.removeAttr("data-ll-status").removeClass("loaded entered")),theme.ImagesLazyLoad.update(o),e[i].dom[s].$zoom.removeClass("invisible"),e[i].current_index=s,e[i].current_image_index=n};this[t][this.indexes[n]].lazyloaded||!this[t][this.indexes[n]].lazyload_hold?l():(this[t][this.indexes[n]].event_zoom_load=!0,this[t][this.indexes[n]].$img.one("load.zoom",(function(){l(),e[t][e.indexes[n]].event_zoom_load=null})))}}else!s&&this[i].current_index&&(s=this[i].current_index,n=this[i].current_image_index),this[t][this.indexes[n]]&&this[t][this.indexes[n]].$img&&(this[t][this.indexes[n]].event_zoom_load&&(this[t][this.indexes[n]].$img.unbind("load.zoom"),this[t][this.indexes[n]].event_zoom_load=null),this[i].dom[s].$zoom.addClass("invisible"),this[i].dom[s].$image.html(""),this[i].dom[s].$container.add(this[i].dom[s].$image).removeAttr("style")),this[i].current_size=null,this[i].current_index=null,this[i].current_image_index=null},this._updateZoomPosition=function(i,e,t,s,n,o){var l=i&&i.changedTouches?1:this.options.zoom_offset_coef,a=i?i.clientY||i.changedTouches[0].clientY:this.clientY,d=i?i.clientX||i.changedTouches[0].clientX:this.clientX,r=n[0].getBoundingClientRect(),h=this[e].current_size.main_image_height*l,c=this[e].current_size.main_image_width*l,u=(this[e].current_size.main_image_height-h)/2,m=(this[e].current_size.main_image_width-c)/2,_=a-r.top,p=d-r.left,g=0,f=0;return this.clientY=a,this.clientX=d,_>=this[e].current_size.main_image_height-u?g=Math.floor((this[e].current_size.main_image_height-2*u)*(this[e].current_size.main_image_height*this.options.zoom_scale_coef-this[e].current_size.main_image_height)/h):_>u&&(g=Math.floor((_-u)*(this[e].current_size.main_image_height*this.options.zoom_scale_coef-this[e].current_size.main_image_height)/h)),p>=this[e].current_size.main_image_width-m?f=Math.floor((this[e].current_size.main_image_width-2*m)*(this[e].current_size.main_image_width*this.options.zoom_scale_coef-this[e].current_size.main_image_width)/c):p>m&&(f=Math.floor((p-m)*(this[e].current_size.main_image_width*this.options.zoom_scale_coef-this[e].current_size.main_image_width)/c)),o||this[e].dom[s].$image.css({transform:`translate3d(${-1*f}px, ${-1*g}px, 0)`}),{clientY:this.clientY,clientX:this.clientX}},this._addZoomImgEvents=function(t,s,n,o,l){window.touch||s.on({mouseenter:function(){e._switchZoom(t,n,o,"function"==typeof l?l():l,!0)},mouseleave:function(){e[t].dom[o].$image.addClass("invisible"),s.removeClass("is-zooming")},mousemove:function(l){e[t].current_size&&(e._updateZoomPosition(l,t,n,o,i(this)),s.addClass("is-zooming"),e[t].dom[o].$image.removeClass("invisible"))}},"img")},this._addZoomImgTouchEvents=function(t,s,n,o,l){if(!window.touch)return;let a,d,r,h,c=!1,u=!1,m=!1;function _(s,l){h=e._updateZoomPosition(s,t,n,o,i(l),!0),r=h,r.clientX=d.clientX-r.clientX,r.clientY=d.clientY-r.clientY}s.on({"close beforeChange":function(){u=!1,m=!1,e[t].dom[o].$image.addClass("invisible"),s.removeClass("is-zooming")}}),s.on({touchstart:function(r){r.preventDefault();let h=!1;c&&(c=!1,h=!0),h?u?(e[t].dom[o].$image.addClass("invisible"),s.removeClass("is-zooming"),s.slick("slickSetOption","swipe",!0),u=!1,m=!1):(clearTimeout(a),e._switchZoom(t,n,o,"function"==typeof l?l():l,!0),d=e._updateZoomPosition(r,t,n,o,i(this)),_(r,this),s.slick("slickSetOption","swipe",!1),s.addClass("is-zooming"),e[t].dom[o].$image.removeClass("invisible"),u=!0,m=!0):u&&(_(r,this),m=!0),h||(c=!0,a=setTimeout((()=>c=!1),400))},touchend:function(){m=!1},touchmove:function(s){u&&m&&e[t].current_size&&e._updateZoomPosition(s,t,n,o,i(this))}},"img")},this._addSingleZoomImgEvents=function(i,t,s,n){this._addZoomImgEvents(i,t,s,0,n),this.$scroll_elem.on("scroll.productgallery."+this.options.id,(function(){e[s][e.indexes["function"==typeof n?n():n]].$img&&t.hasClass("is-zooming")&&e._updateZoomPosition(null,i,s,0,e[s][e.indexes["function"==typeof n?n():n]].$img)}))},this._addMultipleZoomImgEvents=function(t,s,n){var o=0;i.each(this[s],(function(i){this.$img&&e._addZoomImgEvents(t,this.$item,s,o++,(function(){return e.indexes.indexOf(i)}))})),this.$scroll_elem.on("scroll.productgallery."+this.options.id,(function(){var o=0;i.each(e[n],(function(){if(this.$img){if(this.$item.hasClass("is-zooming"))return e._updateZoomPosition(null,t,s,o,this.$img),!1;o++}}))}))},this._getZoomObj(),delete this._initZoom},this._initZoom()),this.options.main.enabled||this.options.fullscreen.enable){this._loadSlideImage=function(i,t){this[i][this.indexes[t]].lazyload_hold&&(this[i][this.indexes[t]].lazyload_hold=null,this[i][this.indexes[t]].$img.hasClass("loaded")?this[i][this.indexes[t]].lazyloaded=!0:this[i][this.indexes[t]].$img.removeClass("lazyload--hold").one("load",(function(){e[i][e.indexes[t]].lazyloaded=!0})),theme.ImagesLazyLoad.update(this[i][this.indexes[t]].$img))},this._loadSlideContent=function(i,e){this._loadSlideImage(i,e),this._loadMedia&&this._loadMedia(i,e)},this._timeoutCheckSliderContent=function(i){this.check_slider_content_timeout=setTimeout((function(){e._checkSliderContent("main_slides")}),i)},this._clearTimeoutCheckSliderContent=function(){this.check_slider_content_timeout&&(clearTimeout(this.check_slider_content_timeout),this.check_slider_content_timeout=null)},this._checkSliderContent=function(t,s){this._clearTimeoutCheckSliderContent();var n,o=!1;i.each(this.indexes,(function(i){e[t][e.indexes[i]].$item.hasClass("slick-active")?(e._loadSlideContent(t,i),(e[t][e.indexes[i]].$video||e[t][e.indexes[i]].$iframe)&&(e.options.gallery_has_video&&e.switchMedia(t,i,o?"pause":"play"),o=!0),!s&&!n&&i>0&&e._loadSlideContent(t,i-1),n=i):(e.options.gallery_has_video&&e.switchMedia(t,i,"pause"),void 0!==n&&i===n+1&&e._loadSlideContent(t,i),s||void 0===n||i!==n+2||e._loadSlideContent(t,i))}))};var o=function(i,t,s){e[i].on({afterChange:function(i,n){e[s]=n,e._checkSliderContent(t)}})}}this.options.main.enabled&&(this._initMainSlider=function(){if(this.$main_slider_wrapper=this.$main_slider.parent("[data-js-product-gallery-main-slider-wrapper]"),this.$buttonXr=this.$gallery.find("[data-js-product-gallery-button-xr]"),this.$main_slider.removeClass("d-none-important"),this.options.main.slick.arrows&&(this.options.main.slick.prevArrow=this.$main_slider_wrapper.find("[data-js-product-gallery-main-arrow-prev]"),this.options.main.slick.nextArrow=this.$main_slider_wrapper.find("[data-js-product-gallery-main-arrow-next]")),this.options.grouped&&(this._groupMainSlider=function(i){this.current_group_main_slider!==i&&(this.options.gallery_has_video&&this.switchMedia("main_slides",this.main_slick.currentSlide,"pause"),this._switchZoom&&this._switchZoom("zooms","main_slides",0,this.main_slick.currentSlide),this.$main_slider.slick("slickUnfilter"),-1!==this.options.group_values.indexOf(i)&&this.$main_slider.slick("slickFilter",'[data-group="'+i+'"], [data-group="video_group"]'),this.$main_slider.slick("setPosition"),this.main_slick=this.$main_slider.slick("getSlick"),this._updateData("main_slides","main_slick",0,i),e._mainGoToSlide(0),this._checkSliderContent("main_slides"),this.current_group_main_slider=i)}),this.$main_slider.one("init",(function(i,t){e.$main_slider_wrapper.addClass("initialized"),theme.Loader.unset(e.$main_slider_wrapper),e.main_slick=t,e._updateData("main_slides","main_slick",e.options.main.slick.initialSlide),e.options.first_load_group||e._checkSliderContent("main_slides",!0),e._mainGoToSlide=function(i){this.$main_slider.slick("slickGoTo",i,!0)},$window.on("theme.changed.breakpoint.productgallery."+e.options.id,(function(){e.$main_slider.slick("setPosition")})),o("$main_slider","main_slides","main_slick")})),this.options.gallery_has_video&&this.$control_gallery.on("click",(function(){e.goToSlide(e.first_video_index)})),this.$main_slider.slick(this.options.main.slick),this.options.enable_zoom&&(this._initMainZoom=function(){this.$main_slider.on({beforeChange:function(i,t,s){e._switchZoom("zooms","main_slides",0,s)},afterChange:function(i,t,s){e._switchZoom("zooms","main_slides",0,s,!0)}}),1===this.options.main.slick.slidesToShow?this._addSingleZoomImgEvents("zooms",this.$main_slider,"main_slides",(function(){return e.main_slick.currentSlide})):this._addMultipleZoomImgEvents("zooms","main_slides","main_slides"),delete this._initMainZoom},this.$main_slider.hasClass("slick-initialized")?this._initMainZoom.call(this):this.$main_slider.on("init",this._initMainZoom.apply(this))),this.options.fullscreen.enable&&this.$main_slider.on("click",(()=>{this.onFullscreenShow()})),this.options.gallery_has_model){const i=function(){window.ShopifyXR?(window.ShopifyXR.addModels(e.options.models_json),window.ShopifyXR.setupXRElements()):document.addEventListener("shopify_xr_initialized",(function(){i()}))};window.Shopify.loadFeatures([{name:"shopify-xr",version:"1.0",onLoad:i}])}delete this._initMainSlider},this._resizeInit((function(){e._initMainSlider.call(e),e.options.first_load_group&&e._groupMainSlider(e.options.first_load_group)}),this.options.main.device)),this.options.thumbnail.enabled&&(this.$thumbnail_slider=this.$gallery.find("[data-js-product-gallery-thumbnail-slider]"),this._initThumbnailSlider=function(){this.$thumbnail_items=this.$thumbnail_slider.find("[data-js-product-gallery-thumbnail-item]"),this.options.grouped&&(this._groupThumbnailSlider=function(i){this.current_group_thumbnail!==i&&(this.$thumbnail_slider.slick("slickUnfilter"),-1!==this.options.group_values.indexOf(i)&&this.$thumbnail_slider.slick("slickFilter",'[data-group="'+i+'"], [data-group="video_group"]'),this.$thumbnail_slider.slick("setPosition"),this.$thumbnail_items=this.$thumbnail_slider.find("[data-js-product-gallery-thumbnail-item]"),this._thumbnailGoToSlide(0),theme.ImagesLazyLoad.update(),this.current_group_thumbnail=i)}),this.$thumbnail_slider.removeClass("d-none-important"),this.options.thumbnail.slick.prevArrow=this.$gallery.find("[data-js-product-gallery-thumbnail-arrow-prev]"),this.options.thumbnail.slick.nextArrow=this.$gallery.find("[data-js-product-gallery-thumbnail-arrow-next]"),this.$thumbnail_slider.one("init",(function(){e.$thumbnail_items.removeClass("current").eq(e.main_slick.currentSlide).addClass("current"),$window.on("theme.changed.breakpoint.productgallery."+e.options.id,(function(){e.$thumbnail_slider.slick("setPosition")})),e._thumbnailGoToSlide=function(i){e.$thumbnail_slider.slick("slickGoTo",i),e.$thumbnail_items.removeClass("current").eq(i).addClass("current")},e.$main_slider.on("beforeChange",(function(i,t,s,n){e._thumbnailGoToSlide(n)})),e.$thumbnail_items.on("click",(function(){var t=i(this);t.hasClass("current")||e.goToSlide(e.$thumbnail_items.index(t))}))})),this.main_slick.currentSlide&&(this.options.thumbnail.slick.initialSlide=this.main_slick.currentSlide),this.$thumbnail_slider.slick(this.options.thumbnail.slick),delete this._initThumbnailSlider},this._resizeInit((function(){e._initThumbnailSlider.call(e),e.current_group_main_slider&&e._groupThumbnailSlider(e.current_group_main_slider)}),this.options.thumbnail.device)),this.options.collage.enabled&&(this.$collage=this.$gallery.find("[data-js-product-gallery-collage]"),this._initCollage=function(){this.$collage_items=this.$collage.find("[data-js-product-gallery-thumbnail-item]"),this.options.grouped&&(this._groupCollage=function(i){var e;this.current_group_collage!==i&&((e=this.$collage.find("[data-js-product-gallery-thumbnail-item]")).removeClass("d-none"),-1!==this.options.group_values.indexOf(i)&&e.not('[data-group="'+i+'"], [data-group="video_group"]').addClass("d-none"),this.$collage_items=this.$collage.find("[data-js-product-gallery-thumbnail-item]").not(".d-none"),this._collageGoToSlide(0),this.current_group_collage=i)}),this.$collage_items.removeClass("current").eq(this.indexes[this.main_slick.currentSlide]).addClass("current"),this._collageGoToSlide=function(i){this.$collage_items.removeClass("current").eq(i).addClass("current")},this.$main_slider.on("beforeChange",(function(i,t,s,n){e._collageGoToSlide(n)})),this.$collage_items.on("click",(function(){var t=i(this);t.hasClass("current")||e.goToSlide(e.$collage_items.index(t))})),delete this._initCollage},this._resizeInit((function(){e._initCollage.call(e)}),this.options.collage.device)),this.options.sheet.enabled&&(this._initSheet=function(){this.$sheet=this.$gallery.find("[data-js-product-gallery-sheet]"),this.$sheet_items=this.$sheet.find("[data-js-product-gallery-sheet-item]"),this.sheet_slides=[],this.sheet_contents={currentSlide:0,$slides:[]},this._updateSheetContentData=function(i){this.sheet_contents.$slides=i?this.$sheet_items:this.$sheet_items.not(".d-none")},this._updateSheetContentData(!0),this._updateData("sheet_slides","sheet_contents",0),this.sheet_slides_all=this.sheet_slides,this.options.grouped?this._groupSheet=function(i){this.current_group_sheet!==i&&(this._switchZoom&&this._switchZoom("zooms","sheet_slides"),this.$sheet_items.removeClass("d-none"),-1!==this.options.group_values.indexOf(i)&&this.$sheet_items.not('[data-group="'+i+'"], [data-group="video_group"]').addClass("d-none"),this._updateSheetContentData(),this._updateData("sheet_slides","sheet_contents",0,i),this.current_group_sheet=i)}:this.options.gallery_has_video&&this.options.video_autoplay&&this.switchMedia("sheet_slides",this.first_video_index,"play"),this.options.gallery_has_video&&(this.$control_gallery.on("click",(function(){e.$scroll_elem[0]===window?i("html, body").velocity("scroll",{offset:e.sheet_slides[e.indexes[e.first_video_index]].$video.offset().top,duration:500,complete:function(){e.options.gallery_has_video&&e.switchMedia("sheet_slides",e.first_video_index,"play")}}):e.$scroll_elem.animate({scrollTop:0},{duration:500,complete:function(){}})})),$window.on("product-gallery-fullscreen.open."+this.options.id,(function(){i.each(e.indexes,(function(i){e.options.gallery_has_video&&e.switchMedia("sheet_slides",i,"pause")}))}))),this.options.fullscreen.enable&&this.$sheet_items.on("click",(()=>{this.onFullscreenShow()})),this.options.enable_zoom&&(this._initSheetZoom=function(){this._addMultipleZoomImgEvents("zooms","sheet_slides","sheet_slides_all"),delete this._initSheetZoom},this._resizeInit((function(){e._initSheetZoom.call(e)}),"desktop")),delete this._initSheet},this._resizeInit((function(){e._initSheet.call(e),e.options.first_load_group&&(e._updateSheetContentData(),e._updateData("sheet_slides","sheet_contents",0,e.options.first_load_group))}),this.options.collage.device)),this.options.single&&(this._initSingle=function(){this.$single=this.$gallery.find("[data-js-product-gallery-main-single]"),this.single_content={currentSlide:0,$slides:this.$single.find("[data-js-product-gallery-main-item]")},this._updateData("single_slides","single_content",0),this.options.enable_zoom&&(this._initSingleZoom=function(){this._addSingleZoomImgEvents("zooms",this.$single,"single_slides",0),delete this._initSingleZoom},this._resizeInit((function(){e._initSingleZoom.call(e)}),"desktop")),delete this._initSingle},this._resizeInit((function(){e._initSingle.call(e)}),"desktop")),this.options.fullscreen.enable&&(this._initFullscreen=function(){this.$control_fullscreen=this.$gallery.find("[data-js-product-gallery-control-fullscreen]"),this.$fullscreen=this.$gallery.find("[data-js-product-gallery-fullscreen]"),this.$fullscreen_slider=this.$gallery.find("[data-js-product-gallery-fullscreen-slider]"),this.options.fullscreen.slick.arrows&&(this.options.fullscreen.slick.prevArrow=this.$fullscreen.find("[data-js-product-gallery-fullscreen-arrow-prev]"),this.options.fullscreen.slick.nextArrow=this.$fullscreen.find("[data-js-product-gallery-fullscreen-arrow-next]")),this.$fullscreenBlockratioHeightStyle=i(`.gallery-style-${this.options.id}`),this.fullscreenBlockratioHeightStyleTemplate=this.$fullscreenBlockratioHeightStyle.attr("data-template"),this.setFullscreenBlockratioHeight=function(){const i=Math.max(document.documentElement.clientHeight,window.innerHeight||0);this.$fullscreenBlockratioHeightStyle.html(this.fullscreenBlockratioHeightStyleTemplate.replace("[styles]",`padding-top: ${i}px !important;`))},this.options.enable_zoom&&(this._initFullscreenZoom=function(){this.$fullscreen_slider.on({"beforeChange close":function(i,t,s){e._switchZoom("fullscreenZooms","fullscreen_slides",0,s)},afterChange:function(i,t,s){e._switchZoom("fullscreenZooms","fullscreen_slides",0,s,!0)}}),this._addZoomImgTouchEvents("fullscreenZooms",this.$fullscreen_slider,"fullscreen_slides",0,(function(){return e.fullscreen_slick.currentSlide}))}),this._toggleFullscreen=function(t,s,n){"show"===(n=n||(this.$fullscreen.hasClass("show")?"hide":"show"))?($body.addClass("product-gallery-fullscreen"),this.$fullscreen.addClass("show").one("transitionend",(function(){e.$fullscreen.removeClass("animate")})).addClass("animate"),setTimeout((function(){e.$fullscreen.addClass("visible"),"0s"===e.$fullscreen.css("transition-duration")&&e.$fullscreen.trigger("transitionend")}),0),i.each(this.indexes,(function(s){var n,o;e[t][e.indexes[s]].$img?(e[t][e.indexes[s]].$blockratio?n=e[t][e.indexes[s]].$blockratio.clone():(n=`\n                                        <div class="product-gallery__blockratio overflow-hidden" data-js-product-gallery-blockratio>\n                                            <div class="product-gallery__blockratio_content w-100 w-100-inner" data-js-product-gallery-blockratio-content>\n                                                ${e[t][e.indexes[s]].$img.parent().parent().html()}\n                                            </div>\n                                        </div>\n                                        `,n=i(n)),(o=n.find("img")).removeAttr("data-ll-status").removeClass("lazyload--hold loaded").addClass("rimage__img--contain"),o[0].hasAttribute("srcset")&&o.addClass("donothide")):e[t][e.indexes[s]].$video?(n=e[t][e.indexes[s]].$video.parent().clone()).find("video").removeClass("playing"):e[t][e.indexes[s]].$iframe?(n=e[t][e.indexes[s]].$iframe.parent().clone()).find("iframe").removeClass("playing"):e[t][e.indexes[s]].$template?n=e[t][e.indexes[s]].$template.clone():e[t][e.indexes[s]].$item.find(".model-viewer-wrapper").length&&(n=e[t][e.indexes[s]].$item.find(".model-viewer-wrapper").clone()),e.$fullscreen_slider.append(i("<div>").addClass("product-gallery__fullscreen_item").attr("data-item-index",s).append(n))})),$window.on("theme.resize.fullscreen.ratio."+e.options.id,(()=>{this._updateData("fullscreen_slides","fullscreen_slick",e[t].currentSlide),this.setFullscreenBlockratioHeight()})),this.$fullscreen_slider.one("init",(function(i,n){e.fullscreen_slick=n,e.fullscreen_slides=[],e._updateData("fullscreen_slides","fullscreen_slick",e[s].currentSlide),e.setFullscreenBlockratioHeight(),e._initFullscreenZoom&&e._initFullscreenZoom.call(e),theme.ImagesLazyLoad.update(),o("$fullscreen_slider","fullscreen_slides","fullscreen_slick"),e.options.gallery_has_video&&(e.switchMedia(t,e[s].currentSlide,"pause"),e.switchMedia("fullscreen_slides",e[s].currentSlide,"play"))})),this.options.fullscreen.slick.initialSlide=e[s].currentSlide,this.$fullscreen_slider.slick(e.options.fullscreen.slick),$body.on("keyup.productgallery.fullscreen."+e.options.id,(function(i){27===i.keyCode?e._toggleFullscreen(null,null,"hide"):37===i.keyCode||40===i.keyCode?e.$fullscreen_slider.slick("slickGoTo",e.fullscreen_slick.currentSlide-1):38!==i.keyCode&&39!==i.keyCode||e.$fullscreen_slider.slick("slickGoTo",e.fullscreen_slick.currentSlide+1)}))):($window.unbind("theme.resize.fullscreen.ratio."+this.options.id),this.$fullscreen_slider.trigger("close"),this.$fullscreen.unbind("transitionend").one("transitionend",(function(){e.$fullscreen.removeClass("show animate"),$body.removeClass("product-gallery-fullscreen"),e.$fullscreen_slider.slick("unslick").off().html("")})).addClass("animate"),setTimeout((function(){e.$fullscreen.hasClass("visible")&&"0s"!==e.$fullscreen.css("transition-duration")||e.$fullscreen.trigger("transitionend"),e.$fullscreen.removeClass("visible")}),0),this.$fullscreen_slider.add(this.$fullscreen_slider.find("img")).off(),$window.unbind("theme.resize.productgallery.fullscreen."+e.options.id),$body.unbind("keyup.productgallery.fullscreen."+e.options.id),this.fullscreen_slick=null,this.fullscreen_slides=null)},this.onFullscreenShow=function(){var i=theme.current.is_desktop?"desktop":"mobile",t=e.options.sheet.enabled&&i===e.options.sheet.device?"sheet_slides":e.options.single?"single_slides":"main_slides",s=e.options.sheet.enabled&&i===e.options.sheet.device?"sheet_contents":e.options.single?"single_content":"main_slick";Loader.loadManually([{type:"styles",name:"plugin_slick"},{type:"scripts",name:"plugin_slick"}],(()=>{this._toggleFullscreen(t,s)})),$window.trigger("product-gallery-fullscreen.open."+e.options.id)},this.$control_fullscreen.on("click",(()=>this.onFullscreenShow())),delete this._initFullscreen},this.$main_slider.hasClass("slick-initialized")?this._initFullscreen.call(this):this.$main_slider.on("init",this._initFullscreen.apply(this))),this.$gallery.addClass("initialized"),delete this._create},_updateData:function(e,t,s,n){var o=this,l=0;if(n&&(-1!==this.options.group_values.indexOf(n)?(this.indexes=[],i.each(this.options.group_values,(function(i,e){e!==n&&"video_group"!==e||o.indexes.push(i)}))):this.indexes=this.indexes_cache),this[t])for(this[e]=[],this.first_video_index=null;l<this.indexes.length;l++){var a,d=i(this[t].$slides[l]),r={},h=d.find("img, video, iframe, template").first(),c=d.find(".model-viewer-wrapper");r.$item=d,h.length?r["$"+h[0].tagName.toLowerCase()]=h:c.length&&(r.$model=c,r.id=c.attr("data-model3d-id")),c.length||"TEMPLATE"===h[0].tagName?"main_slides"===e&&(r.$blockratio=d.find("[data-js-product-gallery-blockratio]")):"IMG"===h[0].tagName?"main_slides"!==e&&"fullscreen_slides"!==e||(l!==s||n?r.lazyload_hold=!0:r.lazyloaded=!0,r.$blockratio=d.find("[data-js-product-gallery-blockratio]"),"fullscreen_slides"===e?(a=theme.current.height_percent/(100/+r.$img.attr("data-aspect-ratio"))*100)<100?(r.$blockratio.attr("data-width",a).css({"max-width":`${a}%`}),r.blockratio_width=a):r.$blockratio.removeAttr("data-width").css({"max-width":""}):r.blockratio_width=r.$blockratio.attr("data-width")):"VIDEO"!==h[0].tagName&&"IFRAME"!==h[0].tagName||null!==o.first_video_index||(o.first_video_index=l),this[e][o.indexes[l]]=r}},_resizeInit:function(i,e){var t="theme.changed.breakpoint.productgallery.init."+this.options.id+"."+Math.random();"all"===e||"desktop"===e&&theme.current.is_desktop||"mobile"===e&&theme.current.is_mobile?i():"desktop"!==e&&"mobile"!==e||$window.on(t,(function(){("desktop"===e&&theme.current.is_desktop||"mobile"===e&&theme.current.is_mobile)&&($window.unbind(t),i())}))},goToSlide:function(i){this._mainGoToSlide&&this._mainGoToSlide(i),this._thumbnailGoToSlide&&this._thumbnailGoToSlide(i),this._collageGoToSlide&&this._collageGoToSlide(i)},goToSlideById:function(i,e){var t;this.options.grouped?(this._groupMainSlider&&this._groupMainSlider(e),this._groupThumbnailSlider&&this._groupThumbnailSlider(e),this._groupCollage&&this._groupCollage(e),this._groupSheet&&this._groupSheet(e)):(-1===(t=this.options.media_id_index.indexOf(i))&&(t=0),this.goToSlide(t))},destroy:function(){this.$main_slider&&this.$main_slider.hasClass("slick-initialized")&&(this._clearTimeoutCheckSliderContent(),this.$main_slider.slick("unslick").off()),this.$thumbnail_items&&this.$thumbnail_slider.slick("unslick").off(),$window.unbind("theme.changed.breakpoint.productgallery"+this.options.id),$window.unbind("theme.resize.productgallery."+this.options.id),$window.unbind("product-gallery-fullscreen.open."+this.options.id),$window.unbind("scroll.productgallery."+this.options.id),$window.unbind("theme.resize.fullscreen.ratio."+this.options.id),$body.unbind("keyup.productgallery.fullscreen."+this.options.id),this.$gallery.find("*").off(),this.$gallery.removeClass("initialized"),i.Widget.prototype.destroy.call(this)}})}(jQueryTheme);